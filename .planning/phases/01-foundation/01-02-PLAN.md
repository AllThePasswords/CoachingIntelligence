---
phase: 01-foundation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - src/data/managers.js
  - src/data/aes.js
  - src/data/feedback.js
  - src/data/timeframes.js
  - src/data/summaries.js
  - src/data/sampleQA.js
  - src/data/citations.js
  - src/data/index.js
autonomous: true

must_haves:
  truths:
    - "Manager data can be imported and filtered by ID"
    - "AE data can be filtered by manager ID"
    - "Feedback data can be filtered by timeframe (30/60/90 days)"
    - "Citation IDs in CALL-XXXX format can be validated and parsed"
    - "Citation lookup returns full feedback record for a call ID"
  artifacts:
    - path: "src/data/index.js"
      provides: "Central data export"
      exports: ["managers", "aes", "feedbackLog", "timeframes", "isValidCitationId", "lookupCitation"]
    - path: "src/data/citations.js"
      provides: "Citation utilities"
      exports: ["isValidCitationId", "formatCitationId", "parseCitationId", "extractCitations", "lookupCitation"]
    - path: "src/data/managers.js"
      provides: "Manager records"
      exports: ["managers", "getManagerById"]
    - path: "src/data/feedback.js"
      provides: "Feedback records"
      exports: ["feedbackLog", "getRecentFeedback"]
  key_links:
    - from: "src/data/citations.js"
      to: "src/data/feedback.js"
      via: "lookupCitation import"
      pattern: "feedbackLog\\.find.*call_id"
    - from: "src/data/index.js"
      to: "src/data/*.js"
      via: "re-exports"
      pattern: "export.*from"
---

<objective>
Create static data layer with all coaching data and citation utilities.

Purpose: Provides the data foundation that all UI components will consume. Without this, no manager cards, AE tables, or citation modals can render real content.

Output: Complete src/data/ module with managers, AEs, feedback, timeframes, summaries, and citation utilities.
</objective>

<execution_context>
@/Users/ericgreene/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ericgreene/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-01-SUMMARY.md
@coaching-intelligence-data/managers.js
@coaching-intelligence-data/aes.js
@coaching-intelligence-data/feedback.js
@coaching-intelligence-data/timeframes.js
@coaching-intelligence-data/summaries.js
@coaching-intelligence-data/sampleQA.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Copy and organize data files into src/data/</name>
  <files>
    src/data/managers.js
    src/data/aes.js
    src/data/feedback.js
    src/data/timeframes.js
    src/data/summaries.js
    src/data/sampleQA.js
  </files>
  <action>
    1. Create src/data/ directory if it doesn't exist

    2. Copy data files from coaching-intelligence-data/ to src/data/:
       - managers.js -> src/data/managers.js
       - aes.js -> src/data/aes.js
       - feedback.js -> src/data/feedback.js
       - timeframes.js -> src/data/timeframes.js
       - summaries.js -> src/data/summaries.js (contains managerSummaries)
       - sampleQA.js -> src/data/sampleQA.js

    3. The source files already have proper ES module exports, so they can be copied directly.
       Each file exports:
       - managers.js: managers array, getManagerById(), getManagersByPerformance()
       - aes.js: aes array, getAEsByManager(), getAEById(), getUndercoached()
       - feedback.js: feedbackLog array, getFeedbackByManager(), getFeedbackByAE(), getFeedbackByCallId(), getRecentFeedback()
       - timeframes.js: timeframes object, getTimeframeData(), getManagerTimeframeData(), getBenchmark(), getScoreTrend()
       - summaries.js: managerSummaries object, getSummaryByManager()
       - sampleQA.js: sampleQA array, findAnswer()

    These files are already well-structured with utility functions. No modifications needed.
  </action>
  <verify>
    Each file can be imported without errors:
    ```javascript
    import { managers } from './data/managers';
    import { aes } from './data/aes';
    import { feedbackLog } from './data/feedback';
    import { timeframes } from './data/timeframes';
    import { managerSummaries } from './data/summaries';
    import { sampleQA } from './data/sampleQA';
    ```
  </verify>
  <done>
    All 6 data files copied to src/data/ and importable.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create citation utilities module</name>
  <files>
    src/data/citations.js
  </files>
  <action>
    Create src/data/citations.js with citation ID utilities:

    ```javascript
    // Citation ID format: CALL-XXXX (4 digits, zero-padded)
    import { feedbackLog } from './feedback.js';

    const CITATION_PATTERN = /^CALL-\d{4}$/;

    /**
     * Validates that a string is a valid citation ID (CALL-XXXX format)
     * @param {string} id - The ID to validate
     * @returns {boolean} True if valid citation ID format
     */
    export const isValidCitationId = (id) => CITATION_PATTERN.test(id);

    /**
     * Formats a numeric ID into citation format
     * @param {number} numericId - The numeric portion (e.g., 1042)
     * @returns {string} Formatted citation ID (e.g., "CALL-1042")
     */
    export const formatCitationId = (numericId) =>
      `CALL-${String(numericId).padStart(4, '0')}`;

    /**
     * Parses a citation ID to extract the numeric portion
     * @param {string} id - The citation ID (e.g., "CALL-1042")
     * @returns {number|null} The numeric ID or null if invalid
     */
    export const parseCitationId = (id) => {
      if (!isValidCitationId(id)) return null;
      return parseInt(id.replace('CALL-', ''), 10);
    };

    /**
     * Extracts all citation IDs from a text string (for AI responses)
     * Matches patterns like [-> CALL-1042] or [CALL-1042]
     * @param {string} text - Text to search for citations
     * @returns {string[]} Array of unique citation IDs found
     */
    export const extractCitations = (text) => {
      // Match [-> CALL-XXXX], [→ CALL-XXXX], or just CALL-XXXX
      const pattern = /(?:\[(?:->|→)?\s*)?(CALL-\d{4})(?:\])?/gi;
      const matches = [];
      let match;
      while ((match = pattern.exec(text)) !== null) {
        matches.push(match[1].toUpperCase());
      }
      return [...new Set(matches)]; // Remove duplicates
    };

    /**
     * Looks up full feedback record for a citation ID
     * @param {string} callId - The citation ID (e.g., "CALL-1042")
     * @returns {Object|undefined} The feedback record or undefined
     */
    export const lookupCitation = (callId) =>
      feedbackLog.find(f => f.call_id === callId);

    /**
     * Gets citation details formatted for display in citation modal
     * @param {string} callId - The citation ID
     * @returns {Object|null} Formatted citation details or null if not found
     */
    export const getCitationDetails = (callId) => {
      const feedback = lookupCitation(callId);
      if (!feedback) return null;

      return {
        callId: feedback.call_id,
        date: feedback.date,
        managerName: feedback.manager_name,
        aeName: feedback.ae_name,
        pipelineStage: feedback.pipeline_stage,
        duration: feedback.duration,
        type: feedback.type,
        feedback: feedback.feedback,
        quality: feedback.quality,
        coachingActivity: {
          listened: feedback.listened,
          attended: feedback.attended,
          hasFeedback: feedback.has_feedback,
          hasComments: feedback.has_comments,
          hasScorecard: feedback.has_scorecard
        }
      };
    };
    ```

    This module provides:
    - isValidCitationId: Check if string matches CALL-XXXX format
    - formatCitationId: Convert number to citation format
    - parseCitationId: Extract number from citation ID
    - extractCitations: Find all citations in AI response text
    - lookupCitation: Get full feedback record by call ID
    - getCitationDetails: Get formatted data for citation modal
  </action>
  <verify>
    Test citation utilities:
    ```javascript
    import { isValidCitationId, formatCitationId, lookupCitation } from './data/citations';

    isValidCitationId('CALL-1042') // true
    isValidCitationId('CALL-42') // false (only 2 digits)
    isValidCitationId('call-1042') // false (lowercase)
    formatCitationId(42) // 'CALL-0042'
    lookupCitation('CALL-1042') // returns feedback record
    ```
  </verify>
  <done>
    Citation utilities module created with validation, parsing, and lookup functions.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create central data index with re-exports</name>
  <files>
    src/data/index.js
  </files>
  <action>
    Create src/data/index.js as the central export point:

    ```javascript
    // Central export point for all data and utilities
    // Import from '@/data' or './data' for cleaner imports

    // Manager data and utilities
    export {
      managers,
      getManagerById,
      getManagersByPerformance
    } from './managers.js';

    // AE data and utilities
    export {
      aes,
      getAEsByManager,
      getAEById,
      getUndercoached
    } from './aes.js';

    // Feedback data and utilities
    export {
      feedbackLog,
      getFeedbackByManager,
      getFeedbackByAE,
      getFeedbackByCallId,
      getRecentFeedback
    } from './feedback.js';

    // Timeframe data and utilities
    export {
      timeframes,
      getTimeframeData,
      getManagerTimeframeData,
      getBenchmark,
      getScoreTrend
    } from './timeframes.js';

    // AI summaries
    export {
      managerSummaries,
      getSummaryByManager
    } from './summaries.js';

    // Sample Q&A for Ask Anything
    export {
      sampleQA,
      findAnswer
    } from './sampleQA.js';

    // Citation utilities
    export {
      isValidCitationId,
      formatCitationId,
      parseCitationId,
      extractCitations,
      lookupCitation,
      getCitationDetails
    } from './citations.js';
    ```

    This enables clean imports like:
    ```javascript
    import { managers, getManagerById, lookupCitation } from './data';
    ```
  </action>
  <verify>
    Test central imports work:
    ```javascript
    import {
      managers,
      getManagerById,
      aes,
      feedbackLog,
      timeframes,
      isValidCitationId,
      lookupCitation
    } from './data';

    // All should be defined
    managers.length // 4
    getManagerById('MGR001').name // 'Sarah Chen'
    aes.length // 16
    feedbackLog.length // 19
    isValidCitationId('CALL-1042') // true
    lookupCitation('CALL-1042').ae_name // 'Alex Rivera'
    ```
  </verify>
  <done>
    Central index exports all data and utilities from single import path.
  </done>
</task>

</tasks>

<verification>
After all tasks complete, verify the data layer:

1. **Import test in App.jsx:**
   Update src/App.jsx to test data imports:
   ```jsx
   import { managers, getManagerById, lookupCitation, isValidCitationId } from './data';

   function App() {
     const sarah = getManagerById('MGR001');
     const citation = lookupCitation('CALL-1042');

     return (
       <div className="min-h-screen bg-bg-page p-8">
         <h1 className="text-3xl font-bold text-text-primary mb-4">
           Data Layer Test
         </h1>
         <p className="text-text-secondary mb-2">
           Managers loaded: {managers.length}
         </p>
         <p className="text-text-secondary mb-2">
           Sarah Chen's score: {sarah.coaching_score}%
         </p>
         <code className="font-mono text-text-tertiary bg-bg-card px-2 py-1 rounded block mt-2">
           {citation.call_id}: "{citation.feedback.substring(0, 50)}..."
         </code>
         <p className="text-text-muted mt-2">
           CALL-1042 valid: {isValidCitationId('CALL-1042') ? 'yes' : 'no'}
         </p>
       </div>
     );
   }

   export default App;
   ```

2. **Dev server check:**
   ```bash
   npm run dev
   ```
   Page should display:
   - "Managers loaded: 4"
   - "Sarah Chen's score: 97%"
   - Citation text preview
   - "CALL-1042 valid: yes"

3. **Build check:**
   ```bash
   npm run build
   ```
   Should complete without errors (no dead code, all imports resolve).
</verification>

<success_criteria>
- [ ] All 6 data files exist in src/data/
- [ ] src/data/citations.js provides isValidCitationId, lookupCitation, extractCitations
- [ ] src/data/index.js re-exports all data and utilities
- [ ] `import { managers } from './data'` works
- [ ] `getManagerById('MGR001')` returns Sarah Chen
- [ ] `lookupCitation('CALL-1042')` returns feedback record
- [ ] `isValidCitationId('CALL-1042')` returns true
- [ ] `getRecentFeedback('MGR001', 30)` filters correctly by days
- [ ] `npm run build` succeeds with data layer
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-02-SUMMARY.md`
</output>
